# Production Environment Configuration
# Active profile: prod

# Kafka Configuration (Production)
spring.kafka.bootstrap-servers=${KAFKA_BOOTSTRAP_SERVERS}
spring.kafka.streams.application-id=unified-market-processor-prod
spring.kafka.streams.properties.auto.offset.reset=earliest
spring.kafka.streams.state-dir=/var/lib/kafka-streams/streamingcandle

# APP-ID PREFIX - Change this to replay data with new consumer groups
# Set to empty string "" for normal production (use existing offsets)
# Updated: 2026-01-03 - New consumer group to consume from earliest
kafka.streams.app-id-prefix=${KAFKA_APP_ID_PREFIX:replay-20260103-prod-}

# Processing Configuration (Production - Optimized)
spring.kafka.streams.properties.processing.guarantee=exactly_once_v2
# OPTIMIZED: Increased from 250ms to 500ms to reduce disk I/O
spring.kafka.streams.properties.commit.interval.ms=500
# OPTIMIZED: Reduced from 20 to 16 to match CPU cores
spring.kafka.streams.properties.num.stream.threads=16

# Input topics (Production)
unified.input.topic.ticks=forwardtesting-data
unified.input.topic.oi=OpenInterest
unified.input.topic.orderbook=Orderbook

# Output topics (Production) - Used for validation only
stream.outputs.candles.1m=candle-complete-1m

# MongoDB Configuration (Production)
spring.data.mongodb.uri=${MONGODB_URI}

# Logging Configuration (Production - Info level)
logging.level.com.kotsin.consumer=INFO
logging.level.org.apache.kafka.streams=WARN
logging.level.org.springframework.kafka=WARN

# Trading Hours (Production) - Used by ConfigurationValidator
trading.hours.nse.start=09:15
trading.hours.nse.end=15:30

# Low-latency window grace overrides (Production)
# Finalized bars flush within ~grace + commit interval after window end
# OPTIMIZED: Reduced to 2s for live data low-latency processing
candles.window.grace.seconds.1m=2
candles.window.grace.seconds.multi=2
orderbook.window.grace.seconds.1m=2
orderbook.window.grace.seconds.multi=2
oi.window.grace.seconds.1m=2
oi.window.grace.seconds.multi=2
