# BUG-023 FIX: Test Configuration for Streaming Candle Module
# Comprehensive test-specific topics to avoid production topic pollution

# Kafka Configuration
spring.kafka.bootstrap-servers=${spring.embedded.kafka.brokers:localhost:9092}

# Kafka Streams Configuration
spring.kafka.streams.application-id=unified-market-processor2-test
spring.kafka.streams.state-dir=/tmp/kafka-streams-test/streamingcandle
spring.kafka.streams.properties.processing.guarantee=at_least_once
spring.kafka.streams.properties.num.stream.threads=1

# BUG-023 FIX: Test-specific input topics
unified.input.topic.ticks=test-ticks
unified.input.topic.oi=test-oi
unified.input.topic.orderbook=test-orderbook

# BUG-023 FIX: Test-specific output topics (all timeframes)
stream.outputs.candles.1m=test-candle-ohlcv-1m
stream.outputs.candles.2m=test-candle-ohlcv-2m
stream.outputs.candles.3m=test-candle-ohlcv-3m
stream.outputs.candles.5m=test-candle-ohlcv-5m
stream.outputs.candles.15m=test-candle-ohlcv-15m
stream.outputs.candles.30m=test-candle-ohlcv-30m

# Test-specific orderbook signal topics
stream.outputs.orderbook.1m=test-orderbook-signals-1m
stream.outputs.orderbook.2m=test-orderbook-signals-2m
stream.outputs.orderbook.3m=test-orderbook-signals-3m
stream.outputs.orderbook.5m=test-orderbook-signals-5m
stream.outputs.orderbook.15m=test-orderbook-signals-15m
stream.outputs.orderbook.30m=test-orderbook-signals-30m

# Test-specific OI topics
stream.outputs.oi.1m=test-oi-metrics-1m
stream.outputs.oi.2m=test-oi-metrics-2m
stream.outputs.oi.3m=test-oi-metrics-3m
stream.outputs.oi.5m=test-oi-metrics-5m
stream.outputs.oi.15m=test-oi-metrics-15m
stream.outputs.oi.30m=test-oi-metrics-30m

# MongoDB Configuration
spring.data.mongodb.uri=mongodb://localhost:27017/tradeIngestion-test
spring.data.mongodb.auto-index-creation=true

# Logging Configuration for Tests
logging.level.com.kotsin.consumer=INFO
logging.level.org.apache.kafka.streams=WARN
logging.level.org.springframework.kafka=WARN

# Disable scheduled tasks and auto-start during tests
spring.task.scheduling.enabled=false
spring.kafka.streams.auto-startup=false

# Test-specific grace periods (shorter for faster tests)
candle.window.grace.seconds.1m=1
candle.window.grace.seconds.multi=2
orderbook.window.grace.seconds.1m=1
orderbook.window.grace.seconds.multi=2
oi.window.grace.seconds.1m=1
oi.window.grace.seconds.multi=2

